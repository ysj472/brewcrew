<%- include('partials/header') %>
<link rel="stylesheet" href="/style/boardlist.css">  
    <div class="content">
        <h2>‚ñ† ÌÉÄÌåÄÍ≤åÏãúÌåê</h2>
        <table class="news-table">
            <thead>
                <tr>
                    <th>Î≤àÌò∏</th>
                    <th>ÎßêÎ®∏Î¶¨</th>
                    <th>Ï†úÎ™©</th>
                    <th>ÎãâÎÑ§ÏûÑ</th>
                    <th>ÏûëÏÑ±Ïùº</th>
                    <th>Ï°∞ÌöåÏàò</th>
                </tr>
            </thead>
            <tbody>
                <% if (notices && notices.length > 0) { %>
                    <% notices.forEach(notice => { %>
                        <tr class="notice-row clickable-row" data-href="/boardDetail?id=<%= notice.id %>">
                            <td data-label="Î≤àÌò∏">Í≥µÏßÄ</td>
                            <td data-label="ÎßêÎ®∏Î¶¨"><%= notice.category || '-' %></td>
                            <td data-label="Ï†úÎ™©">
                            <a href="/boardDetail?id=<%= notice.id %>">üì¢ <%= notice.title %></a>
                            </td>
                            <td data-label="ÎãâÎÑ§ÏûÑ">
                            <div class="profile-wrapper">
                                <img src="<%= notice.brewers_profile_pic || '/img/default-profile.png' %>" class="profile-img">
                                <span class="nickname" data-username="<%= notice.brewers_nickname %>" data-userid="<%= notice.brewers_id %>">
                                <%= notice.brewers_nickname %>
                                </span>

                                <div class="profile-box" style="display: none;">
                                <a class="profileBtn" data-username="<%= notice.brewers_id %>">ÌîÑÎ°úÌïÑ Î≥¥Í∏∞</a>
                                <a class="listBtn" href="/userList?id=<%= notice.brewers_id %>">Í≤åÏãúÍ∏Ä Î≥¥Í∏∞</a>
                                <% if (brewers_id && brewers_id !== notice.brewers_id) { %>
                                    <a href="#" class="send-message" data-username="<%= notice.brewers_nickname %>" data-userid="<%= notice.brewers_id %>">Ï™ΩÏßÄ Î≥¥ÎÇ¥Í∏∞</a>
                                <% } %>
                                </div>
                            </div>
                            </td>
                            <td data-label="ÏûëÏÑ±Ïùº"><%= new Date(notice.created_at).toLocaleDateString('ko-KR') %></td>
                            <td data-label="Ï°∞ÌöåÏàò"><%= notice.views %></td>
                        </tr>
                    <% }); %>
                    <% } %>
                <% if (posts.length > 0) { %>  <!-- Í≤åÏãúÍ∏ÄÏù¥ ÏûàÏùÑ Í≤ΩÏö∞ -->
                    <% posts.forEach((post, index) => { %>
                        <tr class="clickable-row" data-href="/boardDetail?id=<%= post.id %>">
                            <td data-label="Î≤àÌò∏"><%= totalPosts - (currentPage - 1) * postsPerPage - index %></td>
                            <td data-label="ÎßêÎ®∏Î¶¨"><a href="/mlb?category=<%= encodeURIComponent(post.category) %>"><%= post.category %></a></td>
                            <td data-label="Ï†úÎ™©">
                                <a href="/boardDetail?id=<%= post.id %>">
                                    <%= post.title %>
                                  
                                    <% if (post.thumbnail_image) { %> 
                                      üñºÔ∏è
                                    <% } else if (post.thumbnail_video) { %> 
                                      üé¨
                                    <% } %>
                                  </a>                                                                                           
                                <% if (post.comment_count > 0) { %>
                                  <span class="comment-count" style="color: red;">(<%= post.comment_count %>)</span>
                                <% } %>
                              </td>                              
                            <td data-label="ÎãâÎÑ§ÏûÑ">
                                <div class="profile-wrapper">
                                    <img src="<%= post.brewers_profile_pic || '/img/default-profile.png' %>" alt="ÌîÑÎ°úÌïÑ Ïù¥ÎØ∏ÏßÄ" class="profile-img">
                                    <a href="/userList?id=<%= post.brewers_id %>" class="nickname"><%= post.brewers_nickname %></a>
                                </div>
                                <div class="profile-box">
                                    <a id="profileBtn" class="profileBtn" data-username="<%= post.brewers_id %>">ÌîÑÎ°úÌïÑ Î≥¥Í∏∞</a>
                                    <a class="listBtn" href="/userList?id=<%= post.brewers_id %>">Í≤åÏãúÍ∏Ä Î≥¥Í∏∞</a>
                                    <% if (brewers_id && brewers_id !== post.brewers_id) { %>
                                        <a href="#" class="send-message" data-username="<%= post.brewers_nickname %>" data-userid="<%= post.brewers_id %>">Ï™ΩÏßÄ Î≥¥ÎÇ¥Í∏∞</a>
                                    <% } %>
                                </div>
                            </td>
                            <td data-label="ÏûëÏÑ±Ïùº"><%= new Date(post.created_at).toLocaleDateString('ko-KR') %></td>
                            <td data-label="Ï°∞ÌöåÏàò"><%= post.views %></td>
                        </tr>
                    <% }); %>
                <% } else { %>  <!-- Í≤åÏãúÍ∏ÄÏù¥ ÏóÜÏùÑ Í≤ΩÏö∞ -->
                    <tr class="no-post-row">
                        <td colspan="6" class="no-post-cell">Îì±Î°ùÎêú Í≤åÏãúÍ∏ÄÏù¥ ÏóÜÏäµÎãàÎã§.</td>
                    </tr>
                <% } %>
            </tbody>            
        </table>
    </div>
    <%-include('searchBar.ejs')%>
    <div class="number-content">
        <div class="pagination">
            <% if (currentPage > 1) { %>
                <a href="<%= currentPath %>?page=<%= currentPage - 1 %>">&#8592; Ïù¥Ï†Ñ</a>
            <% } %>
        
            <% for (let i = 1; i <= totalPages; i++) { %>
                <a href="<%= currentPath %>?page=<%= i %>" class="<%= i === currentPage ? 'active' : '' %>"><%= i %></a>
            <% } %>
        
            <% if (currentPage < totalPages) { %>
                <a href="<%= currentPath %>?page=<%= currentPage + 1 %>">Îã§Ïùå &#8594;</a>
            <% } %>
        </div>        
        <div>
            <button id="writeBtn">Í∏ÄÏì∞Í∏∞</button>
        </div>
    </div>    
<%- include('partials/footer') %>
<div id="profilePopup" class="profile-popup" style="display: none;"></div>
<script src="/js/script.js"></script>
<script src="/js/page.js"></script>
