<%- include('partials/header') %>
<link rel="stylesheet" href="/style/board.css">
<div class="post-container" data-post-id="<%= post.id %>" data-my-id="<%= brewers_id || '' %>"> 
    <div class="post-header">
        <div>
            <span class="post-meta"><%= post.board %></span>
            <span class="post-meta"> | </span>
            <span class="post-meta"><%= post.category %></span>
            <span class="post-meta"> | </span>

            <% if(brewers_id && brewers_id === post.brewers_id) { %>
            <span class="post-meta-update" onclick="window.location.href='/boardEdit?id=<%= post.id %>'">ìˆ˜ì •</span>
            <span class="post-meta"> | </span>
            <span class="post-meta-delete" onclick="confirmDelete()">ì‚­ì œ</span>
            <form id="deleteForm" action="/boardDelete" method="POST" style="display: none;">
                <input type="hidden" name="postId" value="<%= post.id %>">
            </form>
            <% } %>
        </div>
        <span class="post-meta"><%= new Date(post.created_at).toLocaleString('ko-KR') %></span>
    </div>

    <h2 class="post-title"><%= post.title %></h2>

    <div class="post-author" style="position: relative;">
        <img src="<%= post.brewers_profile_pic %>" alt="í”„ë¡œí•„ ì‚¬ì§„" class="author-img">
        <span class="profile-trigger nickname" data-userid="<%= post.brewers_id %>" data-username="<%= post.brewers_nickname %>">
            <%= post.brewers_nickname %>
        </span>
          <!-- í”„ë¡œí•„ ë°•ìŠ¤ -->
        <div class="profile-box">
            <a class="profileBtn" data-username="<%= post.brewers_id %>">í”„ë¡œí•„ ë³´ê¸°</a>
            <a class="listBtn" href="/userList?id=<%= post.brewers_id %>">ê²Œì‹œê¸€ ë³´ê¸°</a>
            <% if (brewers_id && brewers_id !== post.brewers_id) { %>
            <a href="#" class="send-message" data-username="<%= post.brewers_nickname %>" data-userid="<%= post.brewers_id %>">ìª½ì§€ ë³´ë‚´ê¸°</a>
            <% } %>
        </div>
    </div>    

    <div class="post-content">
        <%- post.content %>
    </div>    

    <% if (post.board !== 'ê³µì§€') { %>
    <div class="vote-container">
        <!-- ì¶”ì²œ ë²„íŠ¼ -->
        <button id="likeBtn" class="vote-btn poten" data-author="<%= post.brewers_id %>">
            ğŸ”¥ ì¶”ì²œ <span id="postLikeCount"><%= post.likeCount %></span>
        </button>

        <!-- ë¹„ì¶”ì²œ ë²„íŠ¼ -->
        <button id="dislikeBtn" class="vote-btn bangchul" data-author="<%= post.brewers_id %>">
            ğŸš« ë¹„ì¶”ì²œ
        </button>
    </div>
    <% } %>  

    <div class="nav-buttons">
        <% if (prevPost) { %>
            <button onclick="location.href='/boardDetail?id=<%= prevPost.id %>'">&lt; ì´ì „ ê¸€</button>
        <% } else { %>
            <button disabled>&lt; ì´ì „ ê¸€</button>
        <% } %>
    
        <button onclick="history.back()">ëª©ë¡ìœ¼ë¡œ</button>
    
        <% if (nextPost) { %>
            <button onclick="location.href='/boardDetail?id=<%= nextPost.id %>'">ë‹¤ìŒ ê¸€ &gt;</button>
        <% } else { %>
            <button disabled>ë‹¤ìŒ ê¸€ &gt;</button>
        <% } %>
    </div>    

    <!-- ëŒ“ê¸€ ì‘ì„± -->
    <div class="comment-section">
        <h3 style="height: 35px;">ëŒ“ê¸€ <span id="comment-count">0</span> ê°œ</h3>
        <!-- ëŒ“ê¸€ ë¦¬ìŠ¤íŠ¸ -->
        <div id="comment-list">
            
        </div>
        <!-- ëŒ“ê¸€ ì‘ì„± í¼ -->
        <% if (brewers_id) { %>
        <form id="commentForm" class="comment-form">
            <textarea name="comment" rows="2" placeholder="ëŒ“ê¸€ì„ ì‘ì„±í•˜ì„¸ìš”."></textarea>
            <button type="submit" id="rippleBtn">ë“±ë¡</button>
        </form>
        <% } else { %>
        <form id="commentForm" class="comment-form">
            <textarea name="comment" rows="2" placeholder="ëŒ“ê¸€ì„ ì‘ì„±í•˜ë ¤ë©´ ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."></textarea>
            <button type="submit" id="rippleBtn">ë“±ë¡</button>
        </form>
        <% } %>
    </div>    
</div>
<%- include('partials/footer') %>
<div id="profilePopup" class="profile-popup" style="display: none;"></div> 
<script src="/js/script.js"></script>
<script src="/js/post.js"></script>
<script src="/js/ripple.js"></script>
<script>
    function confirmDelete() {
      if (confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
        document.getElementById('deleteForm').submit();
      }
    }
</script>
   