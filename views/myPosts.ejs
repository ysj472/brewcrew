<%- include('partials/header') %>
<link rel="stylesheet" href="/style/boardlist.css">
<div class="content">
    <h2>â–  ë‚´ê°€ ì‘ì„±í•œ ê²Œì‹œê¸€</h2>

    <table class="news-table">
        <thead>
            <tr>
                <th>ë²ˆí˜¸</th>
                <th>ê²Œì‹œíŒ</th>
                <th>ì œëª©</th>
                <th>ì‘ì„±ì¼</th>
                <th>ì¡°íšŒìˆ˜</th>
                <th>ê´€ë¦¬</th>
            </tr>
        </thead>
        <tbody>
            <% if (posts.length > 0) { %>
                <% posts.forEach((post, index) => { %>
                    <tr class="clickable-row" data-href="/boardDetail?id=<%= post.id %>">
                        <td data-label="ë²ˆí˜¸"><%= totalPosts - (currentPage - 1) * postsPerPage - index %></td>
                        <td data-label="ê²Œì‹œíŒ"><%= post.board %></td>
                        <td data-label="ì œëª©">
                            <a href="/boardDetail?id=<%= post.id %>">
                                <%= post.title %>
                                <% if (post.comment_count > 0) { %>
                                    <span class="comment-count" style="color: red;">(<%= post.comment_count %>)</span>
                                <% } %>
                                <% if (post.thumbnail_image) { %> ğŸ–¼ï¸ <% } %>
                                <% if (post.thumbnail_video) { %> ğŸ¬ <% } %>
                            </a>
                        </td>
                        <td data-label="ì‘ì„±ì¼"><%= new Date(post.created_at).toLocaleDateString('ko-KR') %></td>
                        <td data-label="ì¡°íšŒìˆ˜"><%= post.views %></td>
                        <td data-label="ê´€ë¦¬">
                            <button onclick="editPost('<%= post.id %>')">ìˆ˜ì •</button>
                            <button onclick="deletePost('<%= post.id %>')">ì‚­ì œ</button>
                        </td>
                    </tr>
                <% }); %>
            <% } else { %>
            <tr class="no-post-row">
                <td colspan="6" class="no-post-cell">ë“±ë¡ëœ ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</td>
            </tr>
            <% } %>
        </tbody>
    </table>

    <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
    <div class="number-content">
        <div class="pagination">
            <% if (currentPage > 1) { %>
                <a href="/myPosts?page=<%= currentPage - 1 %>">&#8592; ì´ì „</a>
            <% } %>

            <% for (let i = 1; i <= totalPages; i++) { %>
                <a href="/myPosts?page=<%= i %>" class="<%= i === currentPage ? 'active' : '' %>"><%= i %></a>
            <% } %>

            <% if (currentPage < totalPages) { %>
                <a href="/myPosts?page=<%= currentPage + 1 %>">ë‹¤ìŒ &#8594;</a>
            <% } %>
        </div>
    </div>
</div>

<script>
function editPost(id) {
    window.location.href = '/boardEdit?id=' + id;
}

function deletePost(id) {
    if (confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        const form = document.createElement('form');
        form.method = 'POST';
        form.action = '/boardDelete';
        
        const input = document.createElement('input');
        input.type = 'hidden';
        input.name = 'postId';
        input.value = id;
        
        form.appendChild(input);
        document.body.appendChild(form);
        form.submit();
    }
}
</script>
<%- include('partials/footer') %>
<script src="/js/page.js"></script>